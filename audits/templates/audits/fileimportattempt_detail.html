{% extends "cases/base.html" %}
{% load cases_tags %}
{% load django_import_data_tags %}
{% load render_table from django_tables2 %}

{% block content %}

<h1>{{ fileimportattempt }}</h1>

<p>
    <a href="{{ fileimportattempt.file_importer.get_absolute_url }}">
        Open File Importer
    </a>
    |
    <a href="file://{{ fileimportattempt.imported_from }}">
        Open original file: {{ fileimportattempt.name }}
    </a>
    |
    <a href="{% url 'fileimportattempt_explain' fileimportattempt.id %}">Explanation of field mappings</a>
</p>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-2">
            <form action="{% url 'fileimporter_reimport' fileimportattempt.file_importer.id %}">
                <input required type="checkbox" name="sanity" value="I am super sure">
                <input required type="submit" name="submit" value="Re-import">
            </form>
        </div>

        <div class="col-lg-10">
            <form action="{% url 'fileimporter_delete_models' fileimportattempt.file_importer.id %}">
                <input required type="checkbox" name="sanity" value="I am super sure">
                <input required type="submit" name="submit" value="Delete">
            </form>
        </div>
    </div>
</div>
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-4">
            <h2 title="Summary of all models that were successfully created during this file import attempt">Models Created from File</h2>
            {{ fileimportattempt.creations | json | safe }}
        </div>

        <div class="col-lg-4">
            <h2 title="General information regarding the file import attempt">File-Level Import Info</h2>
            {% if fileimportattempt.info %}
            {{ fileimportattempt.info | json | safe }}
            {% else %}
            <p>None</p>
            {% endif %}
        </div>

        <div class="col-lg-4">
            <h2 title="Any errors associated with the file import attempt">File-Level Import Errors</h2>
            {% if fileimportattempt.errors %}
            {{ fileimportattempt.errors | json | safe }}
            {% else %}
            <p>None</p>
            {% endif %}
        </div>
    </div>
</div>

<h2 title="Model imports attempted during this file import attempt">Model Import Attempts</h2>

{% filter_table mia_table mia_filter %}


<h2 title="All keys/headers that were ignored during file import attempt">Ignored Headers</h2>
<p>
{% for header in fileimportattempt.ignored_headers %}
    <code>{{ header }}</code>{% if header != fileimportattempt.ignored_headers|last %},{% endif %}
{% endfor %}
</p>




{% endblock %}
